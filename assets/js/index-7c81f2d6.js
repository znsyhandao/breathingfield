import{r as e,o as a,a as t,w as o,b as i,c as n,t as s,d as l,e as u,n as r,f as d,g as c,v as p,h as v,F as m,i as f,j as h,k as g,l as w,m as y}from"./vue-vendor-332c0f76.js";import{S as b,F as x,P as C,W as k,B as $,a as _,b as T,A,c as R,d as E,M as I,e as S,f as P}from"./three-vendor-9cce6b9a.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)}).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const F={BASE_URL:"/breathingfield/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},U={app:{title:F.VITE_APP_TITLE||"å‘¼å¸åœºå†¥æƒ³ç³»ç»Ÿ",version:F.VITE_APP_VERSION||"v1.0.0",env:F.VITE_APP_ENV||F.MODE||"development"},api:{baseUrl:F.VITE_API_URL||"",timeout:3e4,retryCount:3},audio:{baseUrl:F.VITE_AUDIO_BASE_URL||"/audio",fallbackUrl:"https://cdn.example.com/audio",preloadCount:3,cacheSize:10},debug:{enabled:"true"===F.VITE_ENABLE_DEBUG,logLevel:F.VITE_LOG_LEVEL||"info"},features:{voiceRecognition:!0,threeVisualization:!0,multiTrackAudio:!0,speechSynthesis:!0},performance:{maxParticles:5e3,fpsLimit:60,memoryWarningThreshold:.7}},B={class:"container"},M={key:0,class:"debug-info"},L={key:1,class:"audio-loading"},V={class:"input-section"},z={class:"mic-icon"},D={class:"text-input"},W={class:"test-buttons"},O={key:0,class:"transcript-box"},N={class:"transcript-text"},H={class:"transcript-time"},j={key:1,class:"analysis-box"},G={class:"analysis-text"},q={class:"emotion-tags"},K={key:2,class:"suggestions-box"},J={class:"suggestions-grid"},Q=["onClick"],X={class:"suggestion-icon"},Y={class:"suggestion-title"},Z={class:"suggestion-duration"},ee={class:"suggestion-desc"},ae={class:"audio-quality-tag"},te={key:2,class:"player-controls"},oe={class:"time-display"},ie={class:"breathing-guide"},ne={key:0,class:"audio-info"},se={class:"audio-title"},le={class:"audio-desc"},ue={key:0,class:"audio-source-tag"},re={key:1,class:"sound-mixer"},de={class:"mixer-sliders"},ce={class:"track-info"},pe={class:"track-icon"},ve={class:"track-name"},me=["value","onInput"],fe={class:"track-volume"},he={key:2,class:"volume-control"},ge={class:"volume-slider-container"},we=["value"],ye={class:"volume-percent"},be={class:"player-buttons"},xe={key:3,class:"audio-tips"},Ce={class:"tips-content"},ke={class:"tips-text"},$e={key:5,class:"permission-prompt"},_e={class:"permission-content"},Te=((e,a)=>{const t=e.__vccOpts||e;for(const[o,i]of a)t[o]=i;return t})({__name:"BreathingField",setup(w){const y=e=>`/audio/${e}`,F=e(U.debug.enabled);a(()=>{U.debug.enabled});const Te=e(!1),Ae=e(""),Re=e(""),Ee=e(""),Ie=e([]),Se=e(!1),Pe=e([]),Fe=e(!1),Ue=e(0),Be=e(600),Me=e("#4fc3f7"),Le=e(1),Ve=e(!1),ze=e(""),De=e(""),We=e(!1),Oe=e(!1),Ne=e(null),He=e(""),je=e(""),Ge=e(.7),qe=e([]),Ke=e(null),Je=e([]);let Qe=[],Xe=null;const Ye=e(null);let Ze,ea,aa,ta,oa=null,ia=!1;const na=()=>{const e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)return ze.value="âš ï¸ æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«ï¼Œè¯·ä½¿ç”¨Chromeæµè§ˆå™¨",De.value="error",setTimeout(()=>{ze.value=""},3e3),!1;try{return oa=new e,oa.continuous=!1,oa.interimResults=!1,oa.lang="zh-CN",oa.maxAlternatives=1,oa.onstart=()=>{Te.value=!0,ia=!0,ze.value="ğŸ¤ æ­£åœ¨è†å¬...è¯·å¼€å§‹è¯´è¯",De.value="listening"},oa.onresult=e=>{const a=e.results[0][0],t=a.transcript;a.confidence;Re.value=t,Ae.value=t,ze.value="âœ… è¯†åˆ«å®Œæˆ",De.value="success",va(t),setTimeout(()=>{ze.value=""},2e3)},oa.onerror=e=>{Te.value=!1,ia=!1;let a="è¯­éŸ³è¯†åˆ«é”™è¯¯";switch(e.error){case"no-speech":a="æ²¡æœ‰æ£€æµ‹åˆ°è¯­éŸ³ï¼Œè¯·é‡æ–°å°è¯•";break;case"audio-capture":a="æ— æ³•è®¿é—®éº¦å…‹é£";break;case"not-allowed":case"permission-denied":a="éº¦å…‹é£æƒé™è¢«æ‹’ç»",We.value=!0;break;default:a=`è¯†åˆ«é”™è¯¯: ${e.error}`}ze.value=`âŒ ${a}`,De.value="error",setTimeout(()=>{ze.value=""},3e3)},oa.onend=()=>{Te.value=!1,ia=!1},!0}catch(a){return ze.value="âŒ è¯­éŸ³è¯†åˆ«åˆå§‹åŒ–å¤±è´¥",De.value="error",!1}},sa=async()=>{if(!oa){if(!na())return}if(ia)try{oa.stop()}catch(e){}else try{try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop())}catch(a){return ze.value="âŒ éœ€è¦éº¦å…‹é£æƒé™ï¼Œè¯·ç‚¹å‡»å…è®¸",De.value="error",void(We.value=!0)}oa.start()}catch(e){ze.value="âŒ å¯åŠ¨å½•éŸ³å¤±è´¥ï¼Œè¯·é‡è¯•",De.value="error",Te.value=!1}},la=async()=>{try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),ze.value="âœ… éº¦å…‹é£æƒé™å·²è·å¾—",De.value="success",We.value=!1,na(),setTimeout(()=>{ze.value=""},2e3)}catch(e){ze.value="âŒ æ— æ³•è·å–éº¦å…‹é£æƒé™",De.value="error"}},ua=e=>{Re.value=e,Ae.value=e,va(e),ze.value="âœ… æµ‹è¯•è¯­éŸ³å·²è¾“å…¥",De.value="success",setTimeout(()=>{ze.value=""},2e3)},ra=async()=>{Oe.value=!0,ze.value="ğŸ” æ­£åœ¨è¯Šæ–­éŸ³é¢‘æ–‡ä»¶...",De.value="listening";const e=[],a=[y("å¤æ›²å†¥æƒ³æ—‹å¾‹-ä¾ç„¶ä¿ç•™.mp3"),y("æå‡ä¸“æ³¨åŠ›å†¥æƒ³.mp3"),y("å¤æ›²å†¥æƒ³æ—‹å¾‹-.mp3"),y("ç¡çœ çº¯éŸ³ä¹-é£é“ƒ.mp3"),y("çº¯éŸ³ä¹å†¥æƒ³-Alphaå†¥æƒ³.mp3"),y("è½»æ¾çŠ¶æ€å†¥æƒ³.mp3"),y("é˜¿å°”æ³•æ³¢æµªMP3.mp3"),y("é«˜æ•è€…è„±æ•ç¬¬äºŒé›†.mp3")];for(const s of a)try{const a=await fetch(s,{method:"HEAD"});a.ok?e.push(`âœ… ${s.split("/").pop()} å­˜åœ¨`):e.push(`âŒ ${s.split("/").pop()} ä¸å­˜åœ¨ (${a.status})`)}catch(n){e.push(`âŒ ${s.split("/").pop()} æ— æ³•è®¿é—®: ${n.message}`)}const t=await da();e.push(t.message);const o=await ca();e.push(...o);const i=pa();e.push(...i),ze.value="éŸ³é¢‘è¯Šæ–­å®Œæˆï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°",Oe.value=!1,alert("éŸ³é¢‘è¯Šæ–­å®Œæˆ:\n"+e.join("\n")),setTimeout(()=>{ze.value=""},5e3)},da=()=>new Promise(e=>{const a=y("å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­.mp3"),t=new Audio;let o=!1;const i=()=>{o||(o=!0,t.oncanplaythrough=null,t.onerror=null,t.onloadstart=null,t.onprogress=null,t.src="",clearTimeout(n))},n=setTimeout(()=>{i(),e({success:!1,message:"âš ï¸ éŸ³é¢‘åŠ è½½è¶…æ—¶"})},1e4);t.onloadstart=()=>{},t.onprogress=()=>{},t.oncanplaythrough=()=>{i(),t.play().then(()=>{setTimeout(()=>{t.pause(),t.currentTime=0,t.src=""},1e3),e({success:!0,message:"âœ… éŸ³é¢‘æ’­æ”¾æµ‹è¯•é€šè¿‡"})}).catch(a=>{e({success:!1,message:"âŒ éŸ³é¢‘æ’­æ”¾å¤±è´¥: "+a.message})})},t.onerror=a=>{i(),e({success:!1,message:"âŒ éŸ³é¢‘æ’­æ”¾æµ‹è¯•å¤±è´¥"})},t.preload="auto",t.src=a,t.load()}),ca=async()=>{const e=[],a=y("å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­.mp3");try{const t=await fetch(a);if(t.ok){const o=await t.arrayBuffer(),i=await(async(e,a)=>new Promise(t=>{if(!window.AudioContext)return void t({success:!1,message:`âš ï¸ ${a}: æµè§ˆå™¨ä¸æ”¯æŒ AudioContext`});const o=new(window.AudioContext||window.webkitAudioContext);o.decodeAudioData(e.slice(0)).then(e=>{o.close(),t({success:!0,message:`âœ… ${a}: è§£ç æˆåŠŸ (${e.duration.toFixed(2)}ç§’, ${e.sampleRate}Hz)`})}).catch(e=>{o.close(),t({success:!1,message:`âŒ ${a}: è§£ç å¤±è´¥ (${e.message})`})})}))(o,a.split("/").pop());e.push(i.message)}else e.push(`âŒ ${a.split("/").pop()}: æ— æ³•è·å–æ–‡ä»¶`)}catch(t){e.push(`âŒ ${a.split("/").pop()}: å¤„ç†å¤±è´¥ (${t.message})`)}return e},pa=()=>{const e=[],a=document.createElement("audio");return[{type:"audio/mpeg",name:"MP3"},{type:'audio/ogg; codecs="vorbis"',name:"OGG Vorbis"},{type:'audio/ogg; codecs="opus"',name:"OGG Opus"},{type:'audio/mp4; codecs="mp4a.40.2"',name:"AAC (M4A)"},{type:"audio/wav",name:"WAV"},{type:'audio/webm; codecs="vorbis"',name:"WebM Vorbis"},{type:'audio/webm; codecs="opus"',name:"WebM Opus"}].forEach(t=>{const o=a.canPlayType(t.type),i="probably"===o?"âœ… å¾ˆå¯èƒ½æ”¯æŒ":"maybe"===o?"âš ï¸ å¯èƒ½æ”¯æŒ":"âŒ ä¸æ”¯æŒ";e.push(`${i} ${t.name}`)}),window.AudioContext||window.webkitAudioContext?e.push("âœ… æµè§ˆå™¨æ”¯æŒ AudioContext"):e.push("âŒ æµè§ˆå™¨ä¸æ”¯æŒ AudioContext"),e},va=e=>{if(!e||e.trim().length<2)return Ee.value="æ‚¨çš„è¡¨è¾¾æ¯”è¾ƒç®€çŸ­ã€‚æœ‰æ—¶å€™å‹åŠ›ä¼šè®©æˆ‘ä»¬å˜å¾—æ²‰é»˜ï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚è®©æˆ‘ä¸ºæ‚¨æ¨èä¸€äº›åŸºç¡€çš„æ”¾æ¾ç»ƒä¹ ã€‚",Ie.value=[{text:"ğŸ¤« ç®€çŸ­è¡¨è¾¾",class:"subtle"},{text:"ğŸ’­ åˆæ­¥æ¢ç´¢",class:"exploration"}],ha(),void(Se.value=!0);const a=e.toLowerCase();let t="stress",o="work";(a.includes("ç„¦è™‘")||a.includes("ç´§å¼ ")||a.includes("æ‹…å¿ƒ"))&&(t="anxiety"),(a.includes("ç´¯")||a.includes("ç–²æƒ«")||a.includes("ç–²åŠ³"))&&(t="fatigue"),(a.includes("éš¾è¿‡")||a.includes("ä¼¤å¿ƒ")||a.includes("æ‚²ä¼¤"))&&(t="sadness"),(a.includes("å·¥ä½œ")||a.includes("åŠ ç­")||a.includes("è€æ¿"))&&(o="work"),(a.includes("æœªæ¥")||a.includes("è¿·èŒ«")||a.includes("æ–¹å‘"))&&(o="future"),(a.includes("å…³ç³»")||a.includes("æœ‹å‹")||a.includes("å®¶äºº"))&&(o="relationship");const i={anxiety:{text:"ç„¦è™‘",desc:"å¯¹æœªæ¥çš„æ‹…å¿§å’Œä¸å®‰"},stress:{text:"å‹åŠ›",desc:"æ‰¿å—ç€è¾ƒå¤§çš„è´Ÿæ‹…"},fatigue:{text:"ç–²åŠ³",desc:"èº«å¿ƒä¿±ç–²çš„çŠ¶æ€"},sadness:{text:"æ‚²ä¼¤",desc:"å†…å¿ƒæ·±å¤„çš„ä¼¤æ„Ÿ"}},n=i[t]||i.stress,s={work:"å·¥ä½œå‹åŠ›",future:"æœªæ¥è§„åˆ’",relationship:"äººé™…å…³ç³»"}[o]||"å‹åŠ›";Ee.value=`æˆ‘æ„Ÿå—åˆ°æ‚¨æœ‰äº›${n.text}ï¼Œ${n.desc}ã€‚è¿™ä¸»è¦ä¸${s}æœ‰å…³ã€‚æ„Ÿè°¢æ‚¨çš„ä¿¡ä»»åˆ†äº«ï¼Œè®©æˆ‘ä¸ºæ‚¨æ¨èæœ€é€‚åˆçš„å†¥æƒ³ç»ƒä¹ ã€‚`,Ie.value=[{text:`${n.text}`,class:t},{text:`ğŸ’¼ ${s}`,class:o}],ha(a,t,o),Se.value=!0},ma={"å¤æ›²å†¥æƒ³æ—‹å¾‹":"ğŸ¼ å¤æ›²å†¥æƒ³","å¤§è‡ªç„¶çš„å£°ä¹":"ğŸŒ¿ è‡ªç„¶å£°æ™¯","ç¡çœ çº¯éŸ³ä¹":"ğŸ’¤ ç¡çœ éŸ³ä¹","çº¯éŸ³ä¹å†¥æƒ³":"ğŸµ å†¥æƒ³éŸ³ä¹","æå‡ä¸“æ³¨åŠ›":"ğŸ¯ ä¸“æ³¨åŠ›è®­ç»ƒ","è½»æ¾çŠ¶æ€å†¥æƒ³":"ğŸ˜Œ è½»æ¾çŠ¶æ€","é˜¿å°”æ³•æ³¢æµª":"ğŸ§  è„‘æ³¢éŸ³ä¹","é«˜æ•è€…è„±æ•":"ğŸ›¡ï¸ è„±æ•è®­ç»ƒ"},fa=e=>{for(const[a,t]of Object.entries(ma))if(e.includes(a))return t;return"ğŸµ ä¸“ä¸šéŸ³é¢‘"},ha=(e,a="stress",t="work")=>{const o=[{id:"mindfulness",icon:"ğŸ§˜â€â™‚ï¸",title:"æ­£å¿µå‘¼å¸å†¥æƒ³",duration:"8",description:"ä¸“ä¸šå¼•å¯¼å›åˆ°å½“ä¸‹ï¼Œä¸å‘¼å¸è¿æ¥",type:"mindfulness",audioSource:"multi-track",audioFile:y("å¤æ›²å†¥æƒ³æ—‹å¾‹-ä¾ç„¶ä¿ç•™.mp3"),color:"#4CAF50"},{id:"stressRelief",icon:"ğŸŒŠ",title:"å‹åŠ›é‡Šæ”¾å†¥æƒ³",duration:"10",description:"ä¸“ä¸šå¼•å¯¼é‡Šæ”¾èº«å¿ƒç´§å¼ ",type:"stressRelief",audioSource:"single-audio",audioFile:y("å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­.mp3"),color:"#2196F3"},{id:"deepRelaxation",icon:"ğŸ’¤",title:"æ·±åº¦æ”¾æ¾å†¥æƒ³",duration:"15",description:"ä¸“ä¸šå¼•å¯¼è¿›å…¥æ·±åº¦æ”¾æ¾",type:"deepRelaxation",audioSource:"single-audio",audioFile:y("ç¡çœ çº¯éŸ³ä¹-é£é“ƒ.mp3"),color:"#673AB7"},{id:"futureClarity",icon:"âœ¨",title:"æœªæ¥è§„åˆ’å†¥æƒ³",duration:"12",description:"ä¸“ä¸šå¼•å¯¼æ¾„æ¸…ç›®æ ‡",type:"futureClarity",audioSource:"single-audio",audioFile:y("çº¯éŸ³ä¹å†¥æƒ³-Alphaå†¥æƒ³.mp3"),color:"#00BCD4"},{id:"workStress",icon:"ğŸ’¼",title:"å·¥ä½œå‡å‹å†¥æƒ³",duration:"8",description:"ä¸“é—¨é’ˆå¯¹å·¥ä½œå‹åŠ›è®¾è®¡",type:"workStress",audioSource:"single-audio",audioFile:y("æå‡ä¸“æ³¨åŠ›å†¥æƒ³.mp3"),color:"#FF9800"},{id:"anxietyRelief",icon:"ğŸ¯",title:"ç„¦è™‘ç¼“è§£å†¥æƒ³",duration:"10",description:"ä¸“ä¸šå¼•å¯¼å®‰æŠšç„¦è™‘æƒ…ç»ª",type:"anxietyRelief",audioSource:"single-audio",audioFile:y("è½»æ¾çŠ¶æ€å†¥æƒ³.mp3"),color:"#E91E63"},{id:"alphaWaves",icon:"ğŸ§ ",title:"Alphaè„‘æ³¢å†¥æƒ³",duration:"12",description:"Alphaè„‘æ³¢æ·±åº¦æ”¾æ¾",type:"alphaWaves",audioSource:"single-audio",audioFile:y("é˜¿å°”æ³•æ³¢æµªMP3.mp3"),color:"#9C27B0"},{id:"desensitization",icon:"ğŸ›¡ï¸",title:"é«˜æ•è€…è„±æ•è®­ç»ƒ",duration:"15",description:"é’ˆå¯¹é«˜æ•æ„Ÿäººç¾¤è®¾è®¡",type:"desensitization",audioSource:"single-audio",audioFile:y("é«˜æ•è€…è„±æ•ç¬¬äºŒé›†.mp3"),color:"#607D8B"}],i={anxiety:["anxietyRelief","mindfulness","stressRelief","alphaWaves"],fatigue:["deepRelaxation","stressRelief","mindfulness"],sadness:["mindfulness","deepRelaxation","stressRelief"],stress:["stressRelief","mindfulness","workStress","deepRelaxation"]}[a]||["stressRelief","mindfulness"];"work"===t?i.unshift("workStress"):"future"===t&&i.unshift("futureClarity");const n=[...new Set(i)];Pe.value=n.slice(0,4).map(e=>{var a;const t=o.find(a=>a.id===e);if(t){const e=(null==(a=t.audioFile)?void 0:a.split("/").pop())||"";return{...t,audioTypeTag:fa(e),audioSourceText:"multi-track"===t.audioSource?"ğŸ§ å¤šè½¨æ··åˆ":"ğŸµ å•ä¸ªéŸ³é¢‘"}}return null}).filter(Boolean)},ga={localAudioFiles:{mindfulness:`/audio/${encodeURIComponent("å¤æ›²å†¥æƒ³æ—‹å¾‹-ä¾ç„¶ä¿ç•™.mp3")}`,stressRelief:`/audio/${encodeURIComponent("å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­.mp3")}`,deepRelaxation:`/audio/${encodeURIComponent("ç¡çœ çº¯éŸ³ä¹-é£é“ƒ.mp3")}`,futureClarity:`/audio/${encodeURIComponent("çº¯éŸ³ä¹å†¥æƒ³-Alphaå†¥æƒ³.mp3")}`,workStress:`/audio/${encodeURIComponent("æå‡ä¸“æ³¨åŠ›å†¥æƒ³.mp3")}`,anxietyRelief:`/audio/${encodeURIComponent("è½»æ¾çŠ¶æ€å†¥æƒ³.mp3")}`,alphaWaves:`/audio/${encodeURIComponent("é˜¿å°”æ³•æ³¢æµªMP3.mp3")}`,desensitization:`/audio/${encodeURIComponent("é«˜æ•è€…è„±æ•ç¬¬äºŒé›†.mp3")}`,"nature-rain":`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-åŸå¸‚çš„é›¨å¤©.mp3")}`,"nature-fireplace":`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-å£ç‚‰ä¸­çš„å€’å½±.mp3")}`,"nature-spring":`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-æ˜¥ä¹‹æ­Œ.mp3")}`,"nature-ocean":`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-æµ·é£.mp3")}`,"nature-thunder":`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-é›·é›¨å¤œ.mp3")}`,"sleep-master":`/audio/${encodeURIComponent("ç¡çœ çº¯éŸ³ä¹-å¤§å¸ˆè¯´.mp3")}`,"sleep-air":`/audio/${encodeURIComponent("ç¡çœ çº¯éŸ³ä¹-æ¸…æ–°ç©ºæ°”.mp3")}`,"alpha-bell":`/audio/${encodeURIComponent("çº¯éŸ³ä¹å†¥æƒ³-Alphaé’Ÿé“ƒå†¥æƒ³.mp3")}`,"theta-meditation":`/audio/${encodeURIComponent("çº¯éŸ³ä¹å†¥æƒ³-Thetaå†¥æƒ³.mp3")}`,"theta-bell":`/audio/${encodeURIComponent("çº¯éŸ³ä¹å†¥æƒ³-Thetaé’Ÿé“ƒå†¥æƒ³.mp3")}`,ocean:`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-æµ·é£.mp3")}`,singingBowl:`/audio/${encodeURIComponent("é¢‚é’µ-æµ·æ´‹.mp3")}`,wind:`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-æ˜¥ä¹‹æ­Œ.mp3")}`,rain:`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-åŸå¸‚çš„é›¨å¤©.mp3")}`,forest:`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-å£ç‚‰ä¸­çš„å€’å½±.mp3")}`,stream:`/audio/${encodeURIComponent("å¤§è‡ªç„¶çš„å£°ä¹-é›·é›¨å¤œ.mp3")}`,birds:`/audio/${encodeURIComponent("çº¯éŸ³ä¹å†¥æƒ³-Thetaé’Ÿé“ƒå†¥æƒ³.mp3")}`,"breath-in":"/audio/breath_in.wav","breath-out":"/audio/breath_out.wav",bell:"/audio/bell.mp3",alphabell:"/audio/alphabell.mp3",alphabellstandard:"/audio/alphabellstandard.mp3",alphameditation:"/audio/alphameditation.mp3",alphawave:"/audio/alphawave.mp3",fixed_alphabell:"/audio/fixed_alphabell.mp3",fixed_alphabellstandard:"/audio/fixed_alphabellstandard.mp3",fixed_alphameditation:"/audio/fixed_alphameditation.mp3",fixed_alphawave:"/audio/fixed_alphawave.mp3",fixed_attention:"/audio/fixed_attention.mp3",fixed_attentionstandard:"/audio/fixed_attentionstandard.mp3",fixed_rain:"/audio/fixed_rain.mp3",fixed_rainnight:"/audio/fixed_rainnight.mp3",fixed_reflection:"/audio/fixed_reflection.mp3",fixed_releavestate:"/audio/fixed_releavestate.mp3",fixed_seawind:"/audio/fixed_seawind.mp3",fixed_springsong:"/audio/fixed_springsong.mp3",fixed_Thetabell:"/audio/fixed_Thetabell.mp3",fixed_Thetameditation:"/audio/fixed_Thetameditation.mp3","fixed_å¤æ›²å†¥æƒ³æ—‹å¾‹-ä¾ç„¶ä¿ç•™":"/audio/fixed_å¤æ›²å†¥æƒ³æ—‹å¾‹-ä¾ç„¶ä¿ç•™.mp3","fixed_å¤æ›²å†¥æƒ³æ—‹å¾‹-åƒæåœ°æ˜Ÿä¸€æ ·":"/audio/fixed_å¤æ›²å†¥æƒ³æ—‹å¾‹-åƒæåœ°æ˜Ÿä¸€æ ·.mp3","fixed_å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­old":"/audio/fixed_å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­old.mp3","fixed_çœ å°å…”æ—…ä¿®éŸ³é¢‘":"/audio/fixed_çœ å°å…”æ—…ä¿®éŸ³é¢‘.mp3","fixed_ç¡çœ çº¯éŸ³ä¹-å¤§å¸ˆè¯´":"/audio/fixed_ç¡çœ çº¯éŸ³ä¹-å¤§å¸ˆè¯´.mp3","fixed_ç¡çœ çº¯éŸ³ä¹-æ¸…æ–°ç©ºæ°”":"/audio/fixed_ç¡çœ çº¯éŸ³ä¹-æ¸…æ–°ç©ºæ°”.mp3","fixed_ç¡çœ çº¯éŸ³ä¹-é£é“ƒ":"/audio/fixed_ç¡çœ çº¯éŸ³ä¹-é£é“ƒ.mp3","fixed_è½»æ¾çŠ¶æ€å†¥æƒ³":"/audio/fixed_è½»æ¾çŠ¶æ€å†¥æƒ³.mp3","fixed_é«˜æ•è€…è„±æ•ç¬¬ä¸‰é›†":"/audio/fixed_é«˜æ•è€…è„±æ•ç¬¬ä¸‰é›†.mp3","fixed_é«˜æ•è€…è„±æ•ç¬¬äºŒé›†":"/audio/fixed_é«˜æ•è€…è„±æ•ç¬¬äºŒé›†.mp3",meditation_music:"/audio/meditation_music.mp3",releavestate:"/audio/releavestate.mp3","å¤æ›²å†¥æƒ³æ—‹å¾‹-ä¾ç„¶ä¿ç•™":"/audio/å¤æ›²å†¥æƒ³æ—‹å¾‹-ä¾ç„¶ä¿ç•™.mp3","å¤æ›²å†¥æƒ³æ—‹å¾‹-åƒæåœ°æ˜Ÿä¸€æ ·":"/audio/å¤æ›²å†¥æƒ³æ—‹å¾‹-åƒæåœ°æ˜Ÿä¸€æ ·.mp3","å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­":"/audio/å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­.mp3","å¤§è‡ªç„¶çš„å£°ä¹-åŸå¸‚çš„é›¨å¤©":"/audio/å¤§è‡ªç„¶çš„å£°ä¹-åŸå¸‚çš„é›¨å¤©.mp3","å¤§è‡ªç„¶çš„å£°ä¹-å£ç‚‰ä¸­çš„å€’å½±":"/audio/å¤§è‡ªç„¶çš„å£°ä¹-å£ç‚‰ä¸­çš„å€’å½±.mp3","å¤§è‡ªç„¶çš„å£°ä¹-æ˜¥ä¹‹æ­Œ":"/audio/å¤§è‡ªç„¶çš„å£°ä¹-æ˜¥ä¹‹æ­Œ.mp3","å¤§è‡ªç„¶çš„å£°ä¹-æµ·é£":"/audio/å¤§è‡ªç„¶çš„å£°ä¹-æµ·é£.mp3","å¤§è‡ªç„¶çš„å£°ä¹-é›·é›¨å¤œ":"/audio/å¤§è‡ªç„¶çš„å£°ä¹-é›·é›¨å¤œ.mp3","æå‡ä¸“æ³¨åŠ›å†¥æƒ³":"/audio/æå‡ä¸“æ³¨åŠ›å†¥æƒ³.mp3","æå‡ä¸“æ³¨åŠ›å†¥æƒ³standard":"/audio/æå‡ä¸“æ³¨åŠ›å†¥æƒ³standard.mp3","çœ å°å…”æ—…ä¿®éŸ³é¢‘":"/audio/çœ å°å…”æ—…ä¿®éŸ³é¢‘.mp3","çœ å°å…”è½»æ¾çŠ¶æ€å†¥æƒ³":"/audio/çœ å°å…”è½»æ¾çŠ¶æ€å†¥æƒ³.mp3","ç¡çœ çº¯éŸ³ä¹-å¤§å¸ˆè¯´":"/audio/ç¡çœ çº¯éŸ³ä¹-å¤§å¸ˆè¯´.mp3","ç¡çœ çº¯éŸ³ä¹-æ¸…æ–°ç©ºæ°”":"/audio/ç¡çœ çº¯éŸ³ä¹-æ¸…æ–°ç©ºæ°”.mp3","ç¡çœ çº¯éŸ³ä¹-é£é“ƒ":"/audio/ç¡çœ çº¯éŸ³ä¹-é£é“ƒ.mp3","çº¯éŸ³ä¹å†¥æƒ³-Alphaå†¥æƒ³":"/audio/çº¯éŸ³ä¹å†¥æƒ³-Alphaå†¥æƒ³.mp3","çº¯éŸ³ä¹å†¥æƒ³-Alphaé’Ÿé“ƒå†¥æƒ³":"/audio/çº¯éŸ³ä¹å†¥æƒ³-Alphaé’Ÿé“ƒå†¥æƒ³.mp3","çº¯éŸ³ä¹å†¥æƒ³-Thetaå†¥æƒ³":"/audio/çº¯éŸ³ä¹å†¥æƒ³-Thetaå†¥æƒ³.mp3","çº¯éŸ³ä¹å†¥æƒ³-Thetaé’Ÿé“ƒå†¥æƒ³":"/audio/çº¯éŸ³ä¹å†¥æƒ³-Thetaé’Ÿé“ƒå†¥æƒ³.mp3","é˜¿å°”æ³•æ³¢æµªMP3":"/audio/é˜¿å°”æ³•æ³¢æµªMP3.mp3","é¢‚é’µ-å…‰èŠ’":"/audio/é¢‚é’µ-å…‰èŠ’.mp3","é¢‚é’µ-å¤§åœ°":"/audio/é¢‚é’µ-å¤§åœ°.mp3","é¢‚é’µ-å®‡å®™":"/audio/é¢‚é’µ-å®‡å®™.mp3","é¢‚é’µ-æ˜Ÿç©º":"/audio/é¢‚é’µ-æ˜Ÿç©º.mp3","é¢‚é’µ-æ£®æ—":"/audio/é¢‚é’µ-æ£®æ—.mp3","é¢‚é’µ-æ³‰æ°´":"/audio/é¢‚é’µ-æ³‰æ°´.mp3","é¢‚é’µ-æµ·æ´‹":"/audio/é¢‚é’µ-æµ·æ´‹.mp3","é«˜æ•è€…è„±æ•ç¬¬ä¸‰é›†":"/audio/é«˜æ•è€…è„±æ•ç¬¬ä¸‰é›†.mp3","é«˜æ•è€…è„±æ•ç¬¬äºŒé›†":"/audio/é«˜æ•è€…è„±æ•ç¬¬äºŒé›†.mp3"},meditationPresets:{mindfulness:{title:"æ­£å¿µå‘¼å¸å†¥æƒ³",description:"æµ·æ´‹å¾®é£ï¼Œå¼•å¯¼ä¸“æ³¨å‘¼å¸",sounds:[{name:"ocean",volume:.4,type:"background"},{name:"wind",volume:.2,type:"background"},{name:"singingBowl",volume:.3,type:"effect",interval:30}],duration:480,fallbackAudio:`/audio/${encodeURIComponent("å¤æ›²å†¥æƒ³æ—‹å¾‹-ä¾ç„¶ä¿ç•™.mp3")}`},stressRelief:{title:"å‹åŠ›é‡Šæ”¾å†¥æƒ³",description:"ä¸“ä¸šå¼•å¯¼é‡Šæ”¾èº«å¿ƒç´§å¼ ",sounds:[{name:"nature-rain",volume:.3,type:"background"},{name:"singingBowl",volume:.4,type:"effect",interval:45}],duration:600,fallbackAudio:`/audio/${encodeURIComponent("å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­.mp3")}`},deepRelaxation:{title:"æ·±åº¦æ”¾æ¾å†¥æƒ³",description:"ä¸“ä¸šå¼•å¯¼è¿›å…¥æ·±åº¦æ”¾æ¾",sounds:[{name:"nature-ocean",volume:.5,type:"background"},{name:"wind",volume:.2,type:"background"}],duration:900,fallbackAudio:`/audio/${encodeURIComponent("ç¡çœ çº¯éŸ³ä¹-é£é“ƒ.mp3")}`}},soundColors:{ocean:"#2196F3",forest:"#4CAF50",rain:"#607D8B",stream:"#00BCD4",wind:"#9E9E9E",singingBowl:"#FF9800",birds:"#8BC34A","nature-ocean":"#2196F3","nature-rain":"#607D8B","nature-wind":"#9E9E9E","nature-thunder":"#673AB7","nature-spring":"#4CAF50","nature-fireplace":"#FF5722"},soundIcons:{ocean:"ğŸŒŠ",forest:"ğŸŒ²",rain:"ğŸŒ§ï¸",stream:"ğŸ’§",wind:"ğŸƒ",singingBowl:"ğŸ¥£",birds:"ğŸ¦","nature-ocean":"ğŸŒŠ","nature-rain":"ğŸŒ§ï¸","nature-wind":"ğŸƒ","nature-thunder":"âš¡","nature-spring":"ğŸŒ¸","nature-fireplace":"ğŸ”¥"}},wa=async e=>new Promise(a=>{const t=(e=>{if(ga.localAudioFiles[e])return ga.localAudioFiles[e];const a=encodeURIComponent(e);return`${{}.VITE_APP_BASE_URL||""}/audio/${a}`})(e),o=new Audio;o.preload="metadata",o.src=t,o.onloadedmetadata=()=>{o.src="",a({success:!0,url:t,duration:o.duration})},o.onerror=()=>{o.src="",a({success:!1,url:t,error:o.error})},o.load()});a(()=>{F.value&&setTimeout(()=>{(async()=>{const e=["mindfulness","stressRelief","deepRelaxation","futureClarity","workStress","anxietyRelief","alphaWaves","desensitization"],a=[];for(const t of e){const e=await wa(t);a.push({key:t,...e})}return a.forEach(e=>{e.success}),a})().then(e=>{const a=e.filter(e=>!e.success).length;a>0&&(He.value=`${a} ä¸ªéŸ³é¢‘æ–‡ä»¶å¯èƒ½æ— æ³•æ’­æ”¾ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°`)})},2e3)});const ya=async e=>{Ta();const a=Pe.value.find(a=>a.type===e);if(!a)return ze.value="âš ï¸ æœªæ‰¾åˆ°å†¥æƒ³é…ç½®",void(De.value="error");Ne.value={title:a.title,description:a.description,audioSource:"multi-track"===a.audioSource?"multi-track":"single-audio"},je.value=a.audioSource,ze.value=`ğŸµ å¼€å§‹${a.title}...`,De.value="success",Oe.value=!0,He.value=`æ­£åœ¨åŠ è½½${"multi-track"===a.audioSource?"å¤šè½¨":"å•è½¨"}éŸ³é¢‘...`;try{if("multi-track"===a.audioSource)try{await ba(e),He.value=`${a.title} å·²å¼€å§‹ï¼ˆå¤šè½¨æ¨¡å¼ï¼‰`}catch(t){if(!a.audioFile)throw new Error("æ²¡æœ‰å¯ç”¨çš„å¤‡ç”¨éŸ³é¢‘");He.value="å¤šè½¨éŸ³é¢‘åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å•è½¨éŸ³é¢‘...",je.value="single-audio",Ne.value.audioSource="single-audio",await ka(a.audioFile,a.duration),He.value=`${a.title} å·²å¼€å§‹ï¼ˆå•è½¨æ¨¡å¼ï¼‰`}else{if(!a.audioFile)throw new Error("éŸ³é¢‘æ–‡ä»¶è·¯å¾„ä¸ºç©º");await ka(a.audioFile,a.duration),He.value=`${a.title} å·²å¼€å§‹`}Fe.value=!0,Ve.value=!0,Be.value=60*parseInt(a.duration),Ia(),setTimeout(()=>{ze.value="",Oe.value=!1},2e3)}catch(o){ze.value=`âš ï¸ ${a.title} åŠ è½½å¤±è´¥`,De.value="error",He.value=`éŸ³é¢‘åŠ è½½å¤±è´¥: ${o.message}`,Oe.value=!1,Ta()}},ba=async e=>{const a=ga.meditationPresets[e];if(!a)throw new Error(`æœªæ‰¾åˆ°å¤šè½¨éŸ³é¢‘é…ç½®: ${e}`);try{const t=a.sounds.map(async(e,a)=>{try{return await xa(e,a)}catch(t){return null}}),o=await Promise.allSettled(t);if(0===o.filter(e=>"fulfilled"===e.status&&e.value).length)throw new Error("æ‰€æœ‰éŸ³é¢‘è½¨é“åŠ è½½å¤±è´¥");return $a(e),!0}catch(t){throw t}},xa=async(e,a=0)=>{const{name:t,volume:o=.5,type:i="background",interval:n}=e,s=ga.localAudioFiles[t];if(!s)throw new Error(`æœªæ‰¾åˆ°æœ¬åœ°éŸ³é¢‘: ${t}`);return new Promise((e,l)=>{const u=new Audio,r=setTimeout(()=>{l(new Error(`éŸ³é¢‘åŠ è½½è¶…æ—¶: ${t}`))},8e3);u.addEventListener("canplaythrough",()=>{clearTimeout(r),u.volume=o,u.loop="background"===i;const d={audio:u,name:t,volume:o,stop:()=>{u.pause(),u.currentTime=0},setVolume:e=>{u.volume=e}};if(Je.value.push(d),setTimeout(()=>{Fe.value&&Ve.value&&u.play().catch(e=>{l(e)})},1e3*a),"effect"===i&&n){const e=setInterval(()=>{if(Fe.value&&Ve.value){const e=new Audio(s);e.volume=.7*o,e.play(),e.onended=()=>{e.remove()},Qe.push(e)}else clearInterval(e)},1e3*n);d.intervalId=e}e(d)}),u.addEventListener("error",e=>{clearTimeout(r),l(new Error(`éŸ³é¢‘ ${t} åŠ è½½å¤±è´¥`))}),u.preload="auto",u.src=s,u.load()})},Ca=async()=>{ze.value="ğŸ§ æ­£åœ¨æµ‹è¯•å¤šè½¨éŸ³é¢‘...",De.value="listening",Oe.value=!0;try{Ta();const e=ga.meditationPresets.mindfulness;if(!e)throw new Error("æœªæ‰¾åˆ°å¤šè½¨éŸ³é¢‘é…ç½®");for(const a of e.sounds){ga.localAudioFiles[a.name]}await ba("mindfulness"),setTimeout(()=>{Ta(),ze.value="âœ… å¤šè½¨éŸ³é¢‘æµ‹è¯•æˆåŠŸ",Oe.value=!1,He.value="å¤šè½¨éŸ³é¢‘åŠŸèƒ½æ­£å¸¸ï¼Œå¯ä»¥åŒæ—¶æ’­æ”¾å¤šä¸ªå£°éŸ³",setTimeout(()=>{ze.value="",He.value=""},3e3)},3e3)}catch(e){ze.value="âŒ å¤šè½¨éŸ³é¢‘æµ‹è¯•å¤±è´¥",Oe.value=!1,He.value=`æµ‹è¯•å¤±è´¥: ${e.message}`,setTimeout(()=>{ze.value="",He.value=""},3e3)}},ka=async(e,a)=>new Promise((a,t)=>{const o=new Audio;Qe.push(o);Date.now();let i=!1,n=!1;const s=setTimeout(()=>{i||n||(l(),t(new Error("éŸ³é¢‘åŠ è½½è¶…æ—¶ (10ç§’)")))},1e4),l=()=>{o.oncanplaythrough=null,o.onerror=null,o.onloadeddata=null,o.onstalled=null,o.onsuspend=null,o.onloadstart=null,o.onprogress=null,clearTimeout(s)},u=()=>{if(i||n)return;i=!0,l();const e=o.play();if(void 0!==e)e.then(()=>{const e={audio:o,name:"main",volume:Ge.value,stop:()=>{o.pause(),o.currentTime=0},setVolume:e=>{o.volume=e,Ge.value=e}};Je.value=[e],o.onended=()=>{Fe.value&&Sa()},a(e)}).catch(e=>{t(new Error(`æ’­æ”¾å¤±è´¥: ${e.message}`))});else{const e={audio:o,name:"main",volume:Ge.value,stop:()=>{o.pause(),o.currentTime=0},setVolume:e=>{o.volume=e,Ge.value=e}};Je.value=[e],o.onended=()=>{Fe.value&&Sa()},a(e)}};o.oncanplaythrough=u,o.onloadeddata=u,o.onerror=e=>{var a;i||n||(n=!0,l(),t(new Error(`åŠ è½½å¤±è´¥: ${(null==(a=o.error)?void 0:a.message)||"æœªçŸ¥é”™è¯¯"}`)))},o.onloadstart=()=>{},o.onprogress=()=>{},o.onstalled=()=>{},o.onsuspend=()=>{},o.preload="auto",o.src=e,o.volume=Ge.value,o.load(),o.readyState>=3&&setTimeout(u,100)}),$a=e=>{const a=ga.meditationPresets[e];a&&(qe.value=a.sounds.map(e=>{const a=ga.soundColors[e.name]||"#4fc3f7",t=ga.soundIcons[e.name]||"ğŸµ";return{name:_a(e.name),icon:t,volume:e.volume,color:a,soundName:e.name,background:`linear-gradient(to right, ${a} 0%, ${a} ${100*e.volume}%, rgba(255,255,255,0.1) ${100*e.volume}%, rgba(255,255,255,0.1) 100%)`}}))},_a=e=>({ocean:"æµ·æ´‹",forest:"æ£®æ—",rain:"ç»†é›¨",stream:"æºªæµ",wind:"å¾®é£",singingBowl:"é¢‚é’µ",birds:"é¸Ÿé¸£","nature-ocean":"æµ·æ´‹","nature-rain":"é›¨å£°","nature-wind":"é£å£°","nature-thunder":"é›·å£°","nature-spring":"æ˜¥ä¹‹å£°","nature-fireplace":"å£ç‚‰"}[e]||e),Ta=()=>{if(document.querySelectorAll("audio").forEach(e=>{try{e.pause(),e.currentTime=0,e.src="",e.load()}catch(a){}}),Je.value.forEach(e=>{if(e.stop&&"function"==typeof e.stop)try{e.stop()}catch(a){}if(e.intervalId&&clearInterval(e.intervalId),e.audio&&"function"==typeof e.audio.pause)try{e.audio.pause(),e.audio.currentTime=0,e.audio.src="",e.audio.load()}catch(a){}}),Qe.forEach(e=>{try{e.pause(),e.currentTime=0,e.src=""}catch(a){}}),Ke.value&&"function"==typeof Ke.value.close)try{Ke.value.close()}catch(e){}Xe&&(clearInterval(Xe),Xe=null),Je.value=[],qe.value=[],Qe=[],je.value="",Fe.value=!1,Ve.value=!1,Ue.value=0,Oe.value=!1},Aa=async()=>{const e=Ae.value||"é»˜è®¤å‹åŠ›æ”¾æ¾";if(""===e.trim())return ze.value="è¯·è¾“å…¥æ‚¨çš„å‹åŠ›æè¿°",De.value="error",void setTimeout(()=>{ze.value=""},2e3);Re.value=e,va(e)},Ra=async e=>{if(Fe.value){He.value=`å·²æœ‰æ­£åœ¨è¿›è¡Œçš„å†¥æƒ³ï¼Œç‚¹å‡»"ç¡®å®š"å°†åœæ­¢å½“å‰å†¥æƒ³å¹¶å¼€å§‹${e.title}`;if(!(await new Promise(a=>{ze.value=`ç¡®è®¤åœæ­¢å½“å‰å†¥æƒ³å¹¶å¼€å§‹${e.title}ï¼Ÿ`,De.value="listening",setTimeout(()=>{confirm(`ç¡®è®¤åœæ­¢å½“å‰å†¥æƒ³å¹¶å¼€å§‹${e.title}å—ï¼Ÿ`)?(a(!0),He.value=""):(a(!1),He.value="")},100)})))return ze.value="å·²å–æ¶ˆ",void setTimeout(()=>{ze.value=""},1500);Ua(),await new Promise(e=>setTimeout(e,500))}Oe.value=!0,(()=>{try{return Ke.value||(Ke.value=new(window.AudioContext||window.webkitAudioContext)),!0}catch(e){return!1}})(),Ea(e.type),await ya(e.type),ze.value=`ğŸ§˜â€â™€ï¸ å¼€å§‹${e.title}...`,De.value="starting",setTimeout(()=>{ze.value="",Oe.value=!1},2e3)},Ea=e=>{Me.value={mindfulness:"#4CAF50",stressRelief:"#2196F3",deepRelaxation:"#673AB7",futureClarity:"#00BCD4",workStress:"#FF9800",anxietyRelief:"#E91E63",alphaWaves:"#9C27B0",desensitization:"#607D8B"}[e]||"#4fc3f7",Ze&&Ze.fog&&Ze.fog.color.setHex(parseInt(Me.value.replace("#","0x")))},Ia=()=>{Xe&&(clearInterval(Xe),Xe=null),Ue.value=0,Xe=setInterval(()=>Ve.value&&Fe.value?(Le.value=1===Le.value?1.5:1,Ue.value>=Be.value?(clearInterval(Xe),Xe=null,void Sa()):void Ue.value++):(clearInterval(Xe),void(Xe=null)),1e3)},Sa=()=>{if(Ve.value=!1,ze.value="ğŸ‰ å†¥æƒ³å®Œæˆï¼æ„Ÿè§‰å¥½äº›äº†å—ï¼Ÿ",De.value="complete",Ta(),"speechSynthesis"in window){const e=new SpeechSynthesisUtterance("å†¥æƒ³ç»ƒä¹ å·²å®Œæˆï¼Œè¯·æ…¢æ…¢çå¼€çœ¼ç›");e.lang="zh-CN",e.rate=.9,speechSynthesis.speak(e)}setTimeout(()=>{ze.value=""},3e3)},Pa=()=>{Ve.value=!Ve.value,Je.value.forEach(e=>{e.audio&&(Ve.value?e.audio.play():e.audio.pause())}),Ve.value?ze.value="â–¶ï¸ ç»§ç»­æ’­æ”¾":ze.value="â¸ï¸ å·²æš‚åœ",setTimeout(()=>{ze.value=""},1500)},Fa=()=>{Ue.value=0,Ve.value=!0,Je.value.forEach(e=>{e.audio&&(e.audio.currentTime=0,e.audio.play())}),ze.value="ğŸ”„ é‡æ–°å¼€å§‹",setTimeout(()=>{ze.value=""},1500)},Ua=()=>{Ve.value=!1,Fe.value=!1,Ue.value=0,Ta(),ze.value="â¹ï¸ å†¥æƒ³å·²åœæ­¢",setTimeout(()=>{ze.value=""},1500)},Ba=e=>{const a=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},Ma=()=>{Ye.value&&(Ye.value.style.backgroundColor="rgba(255, 0, 0, 0.3)",Ze=new b,Ze.fog=new x(657946,10,50),ea=new C(75,window.innerWidth/window.innerHeight,.1,1e3),ea.position.z=15,aa=new k({canvas:Ye.value,antialias:!0,alpha:!0}),aa.setSize(window.innerWidth,window.innerHeight),aa.setPixelRatio(Math.min(window.devicePixelRatio,2)),aa.setClearColor(657946,1),La(),Va(),za())},La=()=>{const e=new $,a=5e3,t=new Float32Array(15e3),o=new Float32Array(15e3),i=new Float32Array(a);for(let s=0;s<15e3;s+=3){t[s]=50*(Math.random()-.5),t[s+1]=50*(Math.random()-.5),t[s+2]=50*(Math.random()-.5);const e=.3*Math.random()+.6;o[s]=e,o[s+1]=.8,o[s+2]=1,i[s/3]=.5*Math.random()+.1}e.setAttribute("position",new _(t,3)),e.setAttribute("color",new _(o,3)),e.setAttribute("size",new _(i,1));const n=new T({uniforms:{time:{value:0},breath:{value:1}},vertexShader:"\n      uniform float time;\n      uniform float breath;\n      attribute float size;\n      attribute vec3 color;\n      varying vec3 vColor;\n      \n      void main() {\n        vColor = color;\n        vec3 pos = position;\n        float noise = sin(time * 0.5 + position.x * 0.1) * \n                     cos(time * 0.3 + position.y * 0.1) * 0.5;\n        \n        pos.x += noise * breath;\n        pos.y += cos(time * 0.7 + position.z * 0.1) * 0.3 * breath;\n        pos.z += sin(time * 0.4 + position.x * 0.2) * 0.2;\n        \n        vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n        gl_PointSize = size * (10.0 / -mvPosition.z) * (0.5 + breath * 0.5);\n        gl_Position = projectionMatrix * mvPosition;\n      }\n    ",fragmentShader:"\n      varying vec3 vColor;\n      \n      void main() {\n        float distance = length(gl_PointCoord - vec2(0.5));\n        if (distance > 0.5) discard;\n        float strength = 1.0 - distance * 2.0;\n        strength = pow(strength, 3.0);\n        gl_FragColor = vec4(vColor, strength * 0.8);\n      }\n    ",transparent:!0,blending:A,depthWrite:!1});ta=new R(e,n),Ze.add(ta)},Va=()=>{const e=new E(3,32,32),a=new I({color:Me.value,transparent:!0,opacity:.3}),t=new S(e,a);Ze.add(t),new P.Tween(t.scale).to({x:1.2,y:1.2,z:1.2},4e3).easing(P.Easing.Sinusoidal.InOut).yoyo(!0).repeat(1/0).start()},za=()=>{requestAnimationFrame(za),P.update(),ta&&(ta.material.uniforms.time.value+=.01,ta.material.uniforms.breath.value=Le.value,ta.rotation.y+=.001*Le.value,ta.rotation.x+=5e-4),aa.render(Ze,ea)},Da=()=>{ea&&aa&&(ea.aspect=window.innerWidth/window.innerHeight,ea.updateProjectionMatrix(),aa.setSize(window.innerWidth,window.innerHeight))};return a(()=>{setTimeout(()=>{Ma()},500),window.addEventListener("audioerror",e=>{}),na(),Ma(),[y("å¤æ›²å†¥æƒ³æ—‹å¾‹-ä¾ç„¶ä¿ç•™.mp3"),y("å¤æ›²å†¥æƒ³æ—‹å¾‹-åœ¨å¿ƒä¸­.mp3"),y("ç¡çœ çº¯éŸ³ä¹-é£é“ƒ.mp3"),y("çº¯éŸ³ä¹å†¥æƒ³-Alphaå†¥æƒ³.mp3"),y("æå‡ä¸“æ³¨åŠ›å†¥æƒ³.mp3"),y("è½»æ¾çŠ¶æ€å†¥æƒ³.mp3"),y("é˜¿å°”æ³•æ³¢æµªMP3.mp3"),y("é«˜æ•è€…è„±æ•ç¬¬äºŒé›†.mp3")].forEach(e=>{const a=new Audio;a.preload="metadata",a.src=e,a.onloadeddata=()=>{},a.onerror=()=>{}}),window.addEventListener("resize",Da),ze.value="ç‚¹å‡»éº¦å…‹é£è¯´å‡ºä½ çš„å‹åŠ›ï¼Œæˆ–è¾“å…¥æ–‡å­—æè¿°",De.value="listening",setTimeout(()=>{ze.value=""},3e3)}),t(()=>{forceCleanup(),window.removeEventListener("resize",Da),aa&&(aa.dispose(),aa.forceContextLoss&&aa.forceContextLoss()),Qe=[]}),o(Te,e=>{ta&&(ta.material.uniforms.breath.value=e?1.5:1)}),(e,a)=>{var t,o;return i(),n("div",B,[F.value?(i(),n("div",M," Canvas: "+s(null==(t=Ye.value)?void 0:t.clientWidth)+"x"+s(null==(o=Ye.value)?void 0:o.clientHeight)+" | THREE: "+s(e.threeLoaded?"âœ“":"âœ—"),1)):l("",!0),Oe.value?(i(),n("div",L,[...a[8]||(a[8]=[u("div",{class:"loading-spinner"},null,-1),u("div",{class:"loading-text"},"æ­£åœ¨åŠ è½½ä¸“ä¸šå†¥æƒ³éŸ³é¢‘...",-1)])])):l("",!0),u("div",V,[u("div",{class:"voice-input",onClick:sa},[u("div",{class:r(["pulse-ring",{recording:Te.value}])},null,2),u("div",z,s(Te.value?"ğŸ”´":"ğŸ¤"),1),u("span",null,s(Te.value?"æ­£åœ¨è†å¬...ç‚¹å‡»åœæ­¢":"ç‚¹å‡»è¯´å‡ºä½ çš„å‹åŠ›"),1),u("div",{class:r(["voice-wave",{active:Te.value}])},[...a[9]||(a[9]=[d('<div class="wave-bar" data-v-ef398062></div><div class="wave-bar" data-v-ef398062></div><div class="wave-bar" data-v-ef398062></div><div class="wave-bar" data-v-ef398062></div><div class="wave-bar" data-v-ef398062></div>',5)])],2)]),u("div",D,[c(u("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>Ae.value=e),placeholder:"æˆ–ç›´æ¥è¾“å…¥å‹åŠ›æè¿°...",onKeyup:v(Aa,["enter"])},null,544),[[p,Ae.value]]),u("button",{onClick:Aa},"åˆ†æå‹åŠ›")]),u("div",W,[u("button",{onClick:a[1]||(a[1]=e=>ua("å·¥ä½œå‹åŠ›å¤§ï¼Œå¤©å¤©åŠ ç­")),class:"test-btn"},"æµ‹è¯•å·¥ä½œå‹åŠ›"),u("button",{onClick:a[2]||(a[2]=e=>ua("ç„¦è™‘å¤±çœ ç¡ä¸ç€")),class:"test-btn"},"æµ‹è¯•ç„¦è™‘"),u("button",{onClick:a[3]||(a[3]=e=>(async e=>{ze.value="ğŸ”Š æ­£åœ¨æµ‹è¯•éŸ³é¢‘...",De.value="success",await ya(e),setTimeout(()=>{ze.value=""},2e3)})("mindfulness")),class:"test-btn"},"æµ‹è¯•éŸ³é¢‘"),u("button",{onClick:Ca,class:"test-btn"},"æµ‹è¯•å¤šè½¨éŸ³é¢‘"),u("button",{onClick:ra,class:"test-btn"},"éŸ³é¢‘è¯Šæ–­"),u("button",{onClick:a[4]||(a[4]=(...a)=>e.forceCleanup&&e.forceCleanup(...a)),class:"test-btn danger-btn"},"å¼ºåˆ¶æ¸…ç†éŸ³é¢‘")]),Re.value?(i(),n("div",O,[a[10]||(a[10]=u("div",{class:"transcript-header"},"ğŸ—£ï¸ ä½ è¯´çš„æ˜¯ï¼š",-1)),u("div",N,s(Re.value),1),u("div",H,s((new Date).toLocaleTimeString()),1)])):l("",!0),Ee.value?(i(),n("div",j,[a[11]||(a[11]=u("div",{class:"analysis-header"},"ğŸ§  æ™ºèƒ½åˆ†æï¼š",-1)),u("div",G,s(Ee.value),1),u("div",q,[(i(!0),n(m,null,f(Ie.value,e=>(i(),n("span",{key:e,class:r(["emotion-tag",e.class])},s(e.text),3))),128))])])):l("",!0),Se.value?(i(),n("div",K,[a[12]||(a[12]=u("div",{class:"suggestions-header"},"ğŸ’¡ ä¸ºæ‚¨æ¨èï¼š",-1)),u("div",J,[(i(!0),n(m,null,f(Pe.value,(e,a)=>(i(),n("div",{key:a,class:"suggestion-card",onClick:a=>Ra(e)},[u("div",X,s(e.icon),1),u("div",Y,s(e.title),1),u("div",Z,s(e.duration)+"åˆ†é’Ÿ",1),u("div",ee,s(e.description),1),u("div",ae,s(e.audioTypeTag),1)],8,Q))),128))])])):l("",!0)]),u("canvas",{ref_key:"canvas",ref:Ye,class:"visualization-field"},null,512),Fe.value?(i(),n("div",te,[u("div",oe,s(Ba(Ue.value))+" / "+s(Ba(Be.value)),1),u("div",ie,[a[13]||(a[13]=h(" è·Ÿç€ ",-1)),u("span",{class:"breath-dot",style:g({transform:`scale(${Le.value})`,backgroundColor:Me.value})},null,4),a[14]||(a[14]=h(" çš„èŠ‚å¥å‘¼å¸ ",-1))]),Ne.value?(i(),n("div",ne,[u("div",se,s(Ne.value.title),1),u("div",le,s(Ne.value.description),1),Ne.value.audioSource?(i(),n("div",ue,s("local"===Ne.value.audioSource?"ğŸµ æœ¬åœ°éŸ³é¢‘":"ğŸŒ åœ¨çº¿éŸ³é¢‘"),1)):l("",!0)])):l("",!0),qe.value.length>0&&"multi-track"===je.value?(i(),n("div",re,[a[15]||(a[15]=u("div",{class:"mixer-header"},"ğŸšï¸ å£°éŸ³è°ƒèŠ‚",-1)),u("div",de,[(i(!0),n(m,null,f(qe.value,e=>(i(),n("div",{class:"mixer-track",key:e.name},[u("div",ce,[u("span",pe,s(e.icon),1),u("span",ve,s(e.name),1)]),u("input",{type:"range",min:"0",max:"100",value:100*e.volume,onInput:a=>((e,a)=>{const t=qe.value.findIndex(a=>a.name===e);if(-1!==t){qe.value[t].volume=a;const e=qe.value[t].color;qe.value[t].background=`linear-gradient(to right, ${e} 0%, ${e} ${100*a}%, rgba(255,255,255,0.1) ${100*a}%, rgba(255,255,255,0.1) 100%)`;const o=qe.value[t].soundName;Je.value.forEach(e=>{e.name===o&&e.setVolume&&e.setVolume(a)})}})(e.name,a.target.value/100),class:"volume-slider"},null,40,me),u("span",fe,s(Math.round(100*e.volume))+"%",1)]))),128))])])):l("",!0),"single-audio"===je.value?(i(),n("div",he,[a[16]||(a[16]=u("div",{class:"volume-header"},"ğŸ”Š éŸ³é‡æ§åˆ¶",-1)),u("div",ge,[u("input",{type:"range",min:"0",max:"100",value:100*Ge.value,onInput:a[5]||(a[5]=e=>{return a=e.target.value/100,Ge.value=a,void Je.value.forEach(e=>{e.setVolume&&e.setVolume(a)});var a}),class:"volume-slider-single"},null,40,we),u("span",ye,s(Math.round(100*Ge.value))+"%",1)])])):l("",!0),u("div",be,[u("button",{class:"player-btn",onClick:Pa},s(Ve.value?"â¸ï¸":"â–¶ï¸"),1),u("button",{class:"player-btn",onClick:Fa},"ğŸ”„"),u("button",{class:"player-btn",onClick:Ua},"â¹ï¸")])])):l("",!0),He.value?(i(),n("div",xe,[u("div",Ce,[a[17]||(a[17]=u("div",{class:"tips-icon"},"ğŸ’¡",-1)),u("div",ke,s(He.value),1),u("button",{class:"tips-close",onClick:a[6]||(a[6]=e=>He.value="")},"Ã—")])])):l("",!0),ze.value?(i(),n("div",{key:4,class:r(["voice-status",De.value])},s(ze.value),3)):l("",!0),We.value?(i(),n("div",$e,[u("div",_e,[a[18]||(a[18]=u("div",{class:"permission-icon"},"ğŸ¤",-1)),a[19]||(a[19]=u("div",{class:"permission-text"},"éœ€è¦éº¦å…‹é£æƒé™æ¥è¯†åˆ«æ‚¨çš„è¯­éŸ³",-1)),u("button",{class:"permission-btn",onClick:la},"å…è®¸éº¦å…‹é£"),u("button",{class:"permission-btn cancel",onClick:a[7]||(a[7]=e=>We.value=!1)},"å–æ¶ˆ")])])):l("",!0)])}}},[["__scopeId","data-v-ef398062"]]);y({__name:"App",setup:e=>(e,a)=>(i(),w(Te))}).mount("#app");
